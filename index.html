<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TriniBos1 Wiki</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* CSS for the cool UI with Green, Black, Red */
        :root {
            --primary-bg: #1a1a1a; /* Dark Black */
            --secondary-bg: #2a2a2a; /* Slightly lighter black for sections */
            --text-color: #e0e0e0; /* Light grey for readability */
            --highlight-green: #00ff00; /* Vibrant Green */
            --accent-red: #ff4d4d; /* Noticeable Red */
            --border-color: #333;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--primary-bg);
            color: var(--text-color);
            display: flex;
            min-height: 100vh; /* Ensures full height */
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        .container {
            display: flex;
            width: 100%;
        }

        /* Sidebar Styling */
        .sidebar {
            width: 280px; /* Fixed width for sidebar */
            background-color: var(--secondary-bg);
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5); /* Subtle shadow */
            display: flex;
            flex-direction: column;
            position: sticky; /* Make sidebar sticky */
            top: 0;
            height: 100vh; /* Full height */
            overflow-y: auto; /* Allow scrolling for long navigation */
            border-right: 1px solid var(--border-color);
        }

        .wiki-title {
            color: var(--highlight-green);
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.8em;
            border-bottom: 2px solid var(--highlight-green);
            padding-bottom: 10px;
        }

        .main-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .main-nav li {
            margin-bottom: 10px;
            position: relative; /* Needed for dropdown positioning */
        }

        .main-nav a {
            display: block;
            padding: 10px 15px;
            color: var(--text-color);
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s ease, color 0.3s ease;
            cursor: pointer; /* Indicate it's interactive */
        }

        .main-nav a:hover,
        .main-nav a.active {
            background-color: var(--highlight-green);
            color: var(--primary-bg); /* Dark text on green hover */
        }

        /* Dropdown specific styles */
        .dropdown .dropdown-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-right: 15px; /* Space for arrow */
        }

        .dropdown .arrow {
            font-size: 0.8em;
            transition: transform 0.3s ease;
        }

        .dropdown:hover .arrow {
            transform: rotate(180deg);
        }

        .dropdown-menu {
            list-style: none;
            padding: 0;
            margin: 5px 0 0 20px; /* Indent dropdown items */
            background-color: var(--primary-bg); /* Darker background for menu */
            border-left: 2px solid var(--highlight-green); /* Green border */
            display: none; /* Hidden by default */
            position: relative; /* Position relative to parent list item */
            z-index: 10; /* Ensure it's above other content if needed */
            border-radius: 0 5px 5px 0;
        }

        .dropdown-menu li {
            margin-bottom: 0; /* Remove extra margin for sub-items */
        }

        .dropdown-menu a {
            padding: 8px 15px 8px 25px; /* Adjust padding for sub-items */
            font-size: 0.95em;
        }

        .dropdown:hover .dropdown-menu {
            display: block; /* Show menu on hover */
        }

        /* Main Content Styling */
        .content {
            flex-grow: 1; /* Takes remaining space */
            padding: 30px;
            background-color: var(--primary-bg);
            overflow-y: auto; /* Allow content to scroll */
        }

        .content h1, .content h2, .content h3, .content h4 {
            color: var(--highlight-green);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .content h1 { font-size: 2.5em; border-bottom: 2px solid var(--highlight-green); }
        .content h2 { font-size: 2em; }
        .content h3 { font-size: 1.5em; }

        .content p {
            line-height: 1.6;
            margin-bottom: 1em;
        }

        .content ul {
            list-style-type: disc;
            margin-left: 20px;
            margin-bottom: 1em;
        }

        .content ul li {
            margin-bottom: 0.5em;
        }

        .content ol {
            margin-left: 20px;
            margin-bottom: 1em;
        }

        .content ol li {
            margin-bottom: 0.5em;
        }

        .content pre {
            background-color: var(--secondary-bg);
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            color: var(--text-color);
        }

        .content code {
            background-color: rgba(0, 255, 0, 0.1);
            color: var(--highlight-green);
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
        }

        .content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1em;
        }

        .content table th,
        .content table td {
            border: 1px solid var(--border-color);
            padding: 8px;
            text-align: left;
        }

        .content table th {
            background-color: var(--highlight-green);
            color: var(--primary-bg);
        }

        .content a:not(.nav-link) { /* Style for links within content */
            color: var(--highlight-green);
            text-decoration: underline;
        }

        .content a:not(.nav-link):hover {
            color: var(--accent-red);
        }

        /* Specific styling for warnings/notes (using red accent) */
        .content .note, .content .important {
            background-color: rgba(255, 77, 77, 0.1); /* Light red tint */
            border-left: 5px solid var(--accent-red);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .content .note h3, .content .important h3 {
            color: var(--accent-red);
            margin-top: 0;
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h1 class="wiki-title">TriniBos1 Wiki</h1>
            <nav class="main-nav">
                <ul>
                    <li><a href="#home" class="nav-link active">Home</a></li>
                    <li class="dropdown">
                        <a href="#projects" class="nav-link dropdown-toggle">Projects <span class="arrow">â–¼</span></a>
                        <ul class="dropdown-menu">
                            <li><a href="#trkey-keymap-configurator" class="nav-link">TrkEy Keymap Configurator</a></li>
                            </ul>
                    </li>
                    <li><a href="#about" class="nav-link">About</a></li>
                    <li><a href="#contact" class="nav-link">Contact</a></li>
                </ul>
            </nav>
        </aside>

        <main class="content" id="wiki-content">
            <div style="text-align: center; padding: 50px;">
                <h2 style="color: var(--highlight-green);">Loading content...</h2>
                <p>Please wait while we fetch the page.</p>
            </div>
        </main>
    </div>

    <script>
        // JavaScript for Dynamic Content Loading
        const wikiPageUrls = {
            'home': `
                <h1>Welcome to TriniBos1 Wiki!</h1>
                <p>Your centralized knowledge base for all projects managed by <strong>TriniBos1</strong>. This platform is designed to provide comprehensive documentation for users and developers alike.</p>
                
                <h2>What is TriniBos1 Wiki?</h2>
                <p>TriniBos1 Wiki is a dedicated platform for hosting dynamic documentation for various software projects, applications, and initiatives. We aim to provide a user-friendly and developer-centric environment for sharing information efficiently.</p>
                
                <h2>Our Hosted Projects</h2>
                <p>Explore the projects documented on TriniBos1 Wiki:</p>
                <ul>
                    <li><a href="#trkey-keymap-configurator">TrkEy Keymap Configurator</a>: A web-based utility for creating and managing custom keymaps for TrkEy keyboards.</li>
                </ul>

                <h2>How to Use This Wiki</h2>
                <ul>
                    <li><strong>For Users:</strong> Navigate through the "Projects" section in the sidebar to find documentation for the specific application you're interested in.</li>
                    <li><strong>For Project Owners/Contributors:</strong> If you manage a project hosted here or wish to add one, please refer to our <a href="#contact">Contact page</a> for contribution guidelines.</li>
                </ul>
            `,
            // Updated 'projects' to be a message since it's now a dropdown trigger
            'projects': `
                <h1>Please Select a Project</h1>
                <p>Use the dropdown menu under "Projects" in the sidebar to navigate to a specific project page, such as TrkEy Keymap Configurator.</p>
            `,
            'trkey-keymap-configurator': 'https://docs.google.com/document/d/e/2PACX-1vTKMlVJdMZLpRsVtcrg6x9wskp-McY6Q6vDAvlvV20Fn8Gb9KBUH_iA2MlFVidENjDLBiynX8yYUmYE/pub', // Your provided TrkEy Doc URL
            'about': `
                <h1>About TriniBos1 Wiki</h1>
                <p>The TriniBos1 Wiki is maintained by TriniBos1 to provide clear and accessible documentation for all our projects.</p>
                <p>Our vision is to build a community-driven knowledge base that empowers both users and developers to understand, use, and contribute to our software and initiatives.</p>
                <h2>Our Mission</h2>
                <ul>
                    <li>To provide accurate and up-to-date documentation.</li>
                    <li>To foster collaboration and contribution from the community.</li>
                    <li>To make complex technical information easy to understand.</li>
                </ul>
                <p>Thank you for visiting!</p>
            `,
            'contact': `
                <h1>Contact Us</h1>
                <p>If you have any questions, feedback, or need support, please reach out to us:</p>
                <ul>
                    <li><strong>Discord:</strong> Join our community on <a href="https://discord.gg/zJr3sUYY4g">Discord</a> for direct support and discussions.</li>
                    <li><strong>GitHub:</strong> For bug reports or feature requests, please use the <a href="https://github.com/trinibos1/trkey-keymap-configurator/issues">Issues page on GitHub</a>.</li>
                </ul>
            `
        };

        // --- Core Logic ---
        const wikiContentDiv = document.getElementById('wiki-content');
        const navLinks = document.querySelectorAll('.main-nav a[href^="#"]');

        let currentPageId = 'home'; // Default page

        // Function to load content from a URL or directly from string
        async function loadContent(pageId) {
            let contentToDisplay = '';
            const pageEntry = wikiPageUrls[pageId];

            if (!pageEntry) {
                wikiContentDiv.innerHTML = `
                    <h1 style="color: var(--accent-red);">Page Not Found</h1>
                    <p>The content for "${pageId}" is not available in the <code>wikiPageUrls</code> object.</p>
                    <p>Please check the page ID or available content.</p>
                `;
                console.warn(`Content for page "${pageId}" not found in wikiPageUrls.`);
                return;
            }

            // Check if the content is directly embedded HTML (string that does NOT start with 'http')
            if (typeof pageEntry === 'string' && !pageEntry.startsWith('http')) {
                contentToDisplay = pageEntry;
            } else if (typeof pageEntry === 'string' && pageEntry.startsWith('http')) {
                // If it's a string that starts with 'http', assume it's a Google Doc URL
                const url = pageEntry;

                // Log the URL being fetched for debugging
                console.log(`Attempting to fetch content for ${pageId} from URL: ${url}`);

                if (url.includes('YOUR_PROJECTS_DOC_ID_EN')) { // Check if URL is still a placeholder
                    wikiContentDiv.innerHTML = `
                        <h1 style="color: var(--accent-red);">Page Not Found / URL Placeholder</h1>
                        <p>The content for "${pageId}" is not available or its Google Doc URL is a placeholder.</p>
                        <p>Please ensure you have published your Google Doc to the web and updated the <code>wikiPageUrls</code> object in the script with the correct <code>/pub</code> URL for this page.</p>
                        <p>Navigate to a different page or update the code.</p>
                    `;
                    console.warn(`URL for page "${pageId}" not found or is a placeholder in wikiPageUrls.`);
                    return;
                }

                // Display loading indicator only for external fetches
                wikiContentDiv.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <h2 style="color: var(--highlight-green);">Loading content...</h2>
                        <p>Please wait while we fetch the page from Google Docs.</p>
                    </div>
                `; 

                try {
                    const response = await fetch(url);
                    console.log(`Fetch response status for ${pageId}: ${response.status}`);
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status} for ${url}`);
                    }
                    const htmlContent = await response.text();
                    console.log(`Successfully fetched HTML content for ${pageId}.`);
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(htmlContent, 'text/html');
                    
                    // Get the body content
                    let bodyContent = doc.body.innerHTML;

                    // Remove Google Docs footer: "Published using Google Docs Report abuseLearn more"
                    const footerDiv = doc.querySelector('.doc-footer, .kix-page-footer'); 
                    if (footerDiv) {
                        footerDiv.remove();
                        // Re-get innerHTML after removal to ensure it's removed from the string
                        bodyContent = doc.body.innerHTML; 
                    }
                    // Also remove the "Updated automatically every 5 minutes" text if it's separate
                    bodyContent = bodyContent.replace(/Updated automatically every 5 minutes/g, '');

                    // Replace "trkey" with "Trkey" (case-insensitive global replacement)
                    bodyContent = bodyContent.replace(/trkey/gi, 'Trkey');

                    contentToDisplay = bodyContent;

                } catch (error) {
                    console.error(`Failed to load content from Google Doc for ${pageId}:`, error);
                    wikiContentDiv.innerHTML = `
                        <h1 style="color: var(--accent-red);">Error Loading Page</h1>
                        <p>Could not retrieve content from Google Docs for "${pageId}".</p>
                        <p>Please ensure the Google Doc is published to the web and the URL is correct, and check your browser's console for more details.</p>
                        <p>Error details: ${error.message}</p>
                    `;
                    return; // Exit if fetch fails
                }
            } else {
                // This case handles any other unexpected types for pageEntry
                wikiContentDiv.innerHTML = `
                    <h1 style="color: var(--accent-red);">Invalid Page Entry Type</h1>
                    <p>The entry for "${pageId}" in <code>wikiPageUrls</code> is not a valid HTML string or URL.</p>
                `;
                console.error(`Invalid page entry type for "${pageId}".`);
                return;
            }

            // Display the content if it was loaded successfully
            wikiContentDiv.innerHTML = contentToDisplay;
            currentPageId = pageId;
            window.location.hash = `#${pageId}`;

            // Update active state in navigation
            navLinks.forEach(link => {
                // For dropdowns, also ensure the parent 'Projects' link becomes active
                const parentLi = link.closest('li');
                if (link.getAttribute('href') === `#${pageId}`) {
                    link.classList.add('active');
                    if (parentLi && parentLi.classList.contains('dropdown')) {
                        parentLi.querySelector('.dropdown-toggle').classList.add('active');
                    }
                } else {
                    link.classList.remove('active');
                    if (parentLi && parentLi.classList.contains('dropdown')) {
                         // Check if any child link is active, if not, deactivate parent
                        const activeChild = parentLi.querySelector('.dropdown-menu .nav-link.active');
                        if (!activeChild) {
                            parentLi.querySelector('.dropdown-toggle').classList.remove('active');
                        }
                    }
                }
            });
        }

        // Event listener for navigation clicks
        navLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault(); // Prevent default link behavior
                const pageId = link.getAttribute('href').substring(1); // Get page ID from href (e.g., "home")
                loadContent(pageId);
            });
        });

        // Handle initial page load and hash changes
        function handleInitialLoad() {
            const initialPageId = window.location.hash ? window.location.hash.substring(1) : 'home';
            loadContent(initialPageId);
        }

        // Listen for hash changes (e.g., if someone manually changes #home to #about)
        window.addEventListener('hashchange', () => {
            const newPageId = window.location.hash ? window.location.hash.substring(1) : 'home';
            if (newPageId !== currentPageId) { // Only reload if it's a different page
                loadContent(newPageId);
            }
        });

        // Run on page load
        document.addEventListener('DOMContentLoaded', handleInitialLoad);
    </script>
</body>
</html>
